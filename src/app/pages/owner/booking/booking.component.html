<div class="space-y-6">

  <div class="flex justify-between items-center">
    <h2 class="text-xl font-semibold">Customer Bookings</h2>
  </div>

  <div class="bg-white rounded-xl shadow p-4">

    <!-- Loader -->
    <p *ngIf="loading" class="text-center py-4 text-gray-500">Loading...</p>

    <table class="w-full" *ngIf="!loading">
      <thead>
        <tr class="border-b bg-gray-50">
          <th class="py-3 text-left">Customer</th>
          <th class="py-3 text-left">Phone</th>
          <th class="py-3 text-left">Service</th>
          <th class="py-3 text-left">Date</th>
          <th class="py-3 text-left">Time</th>
          <th class="py-3 text-left">Amount</th>
          <th class="py-3 text-left">Status</th>
          <th class="py-3 text-center">Actions</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let b of bookings" class="border-b hover:bg-gray-50">

          <td class="py-2">{{ b.customerName }}</td>
          <td class="py-2">{{ b.customerPhone }}</td>

          <td class="py-2">{{ b.serviceId?.title }}</td>

          <td class="py-2">{{ b.scheduledAt | date:'MMM d, y' }}</td>
          <td class="py-2">{{ b.scheduledAt | date:'shortTime' }}</td>

          <td class="py-2">₹{{ b.serviceId?.price }}</td>

          <td class="py-2">
            <span 
              class="px-3 py-1 rounded-full text-xs font-medium"
              [ngClass]="{
                'bg-yellow-100 text-yellow-700': b.status === 'pending',
                'bg-green-100 text-green-700': b.status === 'confirmed',
                'bg-red-100 text-red-700': b.status === 'cancelled',
                'bg-blue-100 text-blue-700': b.status === 'done'
              }"
            >
              {{ b.status }}
            </span>
          </td>

          <td class="py-2 text-center space-x-3">
            <button class="text-blue-600" (click)="viewDetails(b)">View</button>
            <button class="text-purple-600" (click)="changeStatus(b)">Status</button>
            <button class="text-red-600" (click)="deleteBooking(b)">Delete</button>
          </td>

        </tr>
      </tbody>

    </table>

    <!-- Empty state -->
    <p *ngIf="!loading && bookings.length === 0" class="text-center py-4 text-gray-500">
      No bookings available.
    </p>

  </div>

  <!-- Modal -->
  <div 
    *ngIf="showDetails" 
    class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50"
  >
    <div class="bg-white p-6 rounded-xl shadow-lg w-96">

      <h3 class="text-lg font-semibold mb-3">Booking Details</h3>

      <p><strong>Customer:</strong> {{ selected?.customerName }}</p>
      <p><strong>Phone:</strong> {{ selected?.customerPhone }}</p>
      <p><strong>Service:</strong> {{ selected?.serviceId?.title }}</p>
      <p><strong>Date:</strong> {{ selected?.scheduledAt | date:'MMM d, y' }}</p>
      <p><strong>Time:</strong> {{ selected?.scheduledAt | date:'shortTime' }}</p>
      <p><strong>Amount:</strong> ₹{{ selected?.serviceId?.price }}</p>
      <p><strong>Status:</strong> {{ selected?.status }}</p>

      <div class="flex justify-end mt-5">
        <button 
          class="px-4 py-2 bg-gray-200 rounded-lg"
          (click)="closeDetails()"
        >
          Close
        </button>
      </div>

    </div>
  </div>

</div>
